(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bd8a1b7e"],{"2fdb":function(e,t,n){"use strict";var a=n("5ca1"),i=n("d2c8"),r="includes";a(a.P+a.F*n("5147")(r),"String",{includes:function(e){return!!~i(this,e,r).indexOf(e,arguments.length>1?arguments[1]:void 0)}})},5147:function(e,t,n){var a=n("2b4c")("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[a]=!1,!"/./"[e](t)}catch(i){}}return!0}},"54d9":function(e,t,n){"use strict";var a=n("b347"),i=n.n(a);i.a},6762:function(e,t,n){"use strict";var a=n("5ca1"),i=n("c366")(!0);a(a.P,"Array",{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")("includes")},aae3:function(e,t,n){var a=n("d3f4"),i=n("2d95"),r=n("2b4c")("match");e.exports=function(e){var t;return a(e)&&(void 0!==(t=e[r])?!!t:"RegExp"==i(e))}},b347:function(e,t,n){},ccb6:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"loading","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[n("div",{staticClass:"google-map",attrs:{id:"map"}})])},i=[],r=(n("8e6e"),n("456d"),n("c5f6"),n("96cf"),n("3b8d")),o=(n("6762"),n("2fdb"),n("7f7f"),n("ac6a"),n("bd86")),s=n("2f62"),c=(n("5935"),n("2155")),l=n("003d"),u=n("5c96"),m=n("ed22");function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(n,!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var g={props:{},computed:f({},Object(s["e"])("Home",["markUrl","passCategory","queryString","currentPosition","queryDistance","destinations","initialMapSetting","map","lang"]),{},Object(s["e"])(["loading"]),{},Object(s["d"])("Home",["setDestinations"]),{},Object(s["c"])("Home",[]),{currPosition:function(){return this.currentPosition}}),data:function(){return{infowindow:null,markers:[],locations:[],osakaPass:c["a"]}},watch:{},mounted:function(){var e=this;this.initMap(12),l["a"].$on("queryString",(function(t){e.initMap(14),t.eventType?e.getInfoFromQuery(e.queryString,void 0):e.getDistance()}))},methods:f({},Object(s["b"])("Home",["initMap"]),{resetCenter:function(){this.map.setOptions({center:{lat:this.initialMapSetting.center.default.lat,lng:this.initialMapSetting.center.default.lng}})},clearMarkers:function(){this.markers.forEach((function(e){return e.setMap(null)})),this.markers=[]},getInfoFromQuery:function(e,t){var n=new google.maps.places.PlacesService(this.map);n.findPlaceFromQuery({query:t?e.dm.proto.fields.name.stringValue:e,fields:["name","geometry","formatted_address"]},this.fieldResult(e,t))},fieldResult:function(e,t){var n=this,a=["osaka","大阪","Osaka"];function i(e,t){return!t||!t.includes(e)}return function(){var o=Object(r["a"])(regeneratorRuntime.mark((function r(o,s){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:"OVER_QUERY_LIMIT"==s&&u["MessageBox"].alert("System is busy ! Please try again!","hint",{confirmButtonText:"OK",callback:function(){}}),void 0===t?("OK"===s&&n.$store.commit("Home/setCurrentPosition",{lat:o[0].geometry.location.lat(),lng:o[0].geometry.location.lng(),name:o[0].name,address:o[0].formatted_address}),"ZERO_RESULTS"===s&&u["MessageBox"].alert("Can't find this place, please try again!","hint",{confirmButtonText:"OK",callback:function(){n.initMap(12)}}),a.every((function(e){return i(e,n.currPosition.address)}))&&u["MessageBox"].alert("This location is not in osaka ! Please search again!","hint",{confirmButtonText:"OK",callback:function(){n.initMap(12)}}),n.currPosition.lat&&n.currPosition.lng&&n.getDistance()):"OK"===s&&m["b"].collection("2020-4-6").doc(e.id).update({info:{idx:t,location:{lat:o[0].geometry.location.lat(),lng:o[0].geometry.location.lng()},name:o[0].name,address:o[0].formatted_address}});case 2:case"end":return r.stop()}}),r)})));return function(e,t){return o.apply(this,arguments)}}()},getDistance:function(){var e=this;function t(e,t,a,i){var r=6371,o=n(a-e),s=n(i-t),c=Math.sin(o/2)*Math.sin(o/2)+Math.cos(n(e))*Math.cos(n(a))*Math.sin(s/2)*Math.sin(s/2),l=2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)),u=r*l;return u}function n(e){return e*(Math.PI/180)}m["b"].collection("2020-4-6").get().then((function(n){n.docs.forEach((function(n){var a=n.dm.proto.fields;if(a.info){var i=t(a.info.mapValue.fields.location.mapValue.fields.lat.doubleValue,a.info.mapValue.fields.location.mapValue.fields.lng.doubleValue,e.currentPosition.lat,e.currentPosition.lng);i<=e.queryDistance&&e.marker(n)}}))})),this.marker(this.currPosition)},marker:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,a,i,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.type?(n=t.lat,a=t.lng,i="https://image.flaticon.com/icons/svg/1329/1329665.svg"):(n=t.dm.proto.fields.info.mapValue.fields.location.mapValue.fields.lat.doubleValue,a=t.dm.proto.fields.info.mapValue.fields.location.mapValue.fields.lng.doubleValue,i="https://image.flaticon.com/icons/svg/684/684908.svg"),r=new google.maps.Marker({map:this.map,position:new google.maps.LatLng(n,a),icon:{url:i,size:new google.maps.Size(35,35),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(35,35)}}),this.markerInfo(r,t);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),markerInfo:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=this.lang,i=this.$store,e.next=4,google.maps.event.addListener(t,"click",(function(){var e="tc"==a?"name":"".concat(a,"Name"),t="tc"==a?"content":"".concat(a,"Content");i.commit("Home/setLocationInfo",{name:n.name?n.name:"".concat(n.dm.proto.fields[e].stringValue),address:n.name?"":"".concat(n.dm.proto.fields.info.mapValue.fields.address.stringValue),content:n.name?"":"".concat(JSON.parse(JSON.stringify(n.dm.proto.fields[t])).stringValue)});var r=[],o=[];"my location"!=n.name&&n.dm.proto.fields.ratings&&n.dm.proto.fields.ratings.arrayValue.values&&n.dm.proto.fields.ratings.arrayValue.values.forEach((function(e){r.push({userName:e.mapValue.fields.userName.stringValue,rate:Number(e.mapValue.fields.rate.integerValue),comment:e.mapValue.fields.comment.stringValue}),o.push(Number(e.mapValue.fields.rate.integerValue))}));var s=function(e){return e.reduce((function(e,t){return e+t}))/e.length};i.commit("Home/setRateSum",{count:o.length,ave:o.length?s(o).toFixed(1):""}),i.commit("Home/setRatingCommentsRefId",n.id),i.commit("Home/setRatingComments",r),"my location"!=n.name&&i.commit("Home/setInfoRatingVisible",!0)}));case 4:this.$store.commit("Home/setInitialMapSetting",{name:"center",data:{lat:this.currPosition.lat,lng:this.currPosition.lng}}),this.resetCenter(),this.$store.commit("setLoading",!1);case 7:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}(),dbImport:function(){m["b"].collection("2020-4-6").get().then((function(e){e.docs.forEach((function(e,t){e.dm.proto.fields.ratings||m["b"].collection("2020-4-6").doc(e.id).update({ratings:[]})}))}))}}),beforeDestroy:function(){l["a"].$off("queryString")}},p=g,h=(n("54d9"),n("2877")),b=Object(h["a"])(p,a,i,!1,null,null,null);t["default"]=b.exports},d2c8:function(e,t,n){var a=n("aae3"),i=n("be13");e.exports=function(e,t,n){if(a(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(e))}}}]);
//# sourceMappingURL=chunk-bd8a1b7e.6d3aa3f9.js.map